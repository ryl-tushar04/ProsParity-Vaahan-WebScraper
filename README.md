# Vahan Data Automation Pipeline

An automated data extraction and processing system for collecting vehicle registration statistics from the Government of India's Vahan Dashboard portal.

## Overview

This project automates the collection of vehicle registration data across multiple Indian states and Regional Transport Offices (RTOs). Built during an internship, it streamlines what would otherwise be a manual, time-consuming process into a fully automated pipeline.

### What It Does

- **Extracts** vehicle registration data using Selenium WebDriver
- **Converts** downloaded Excel files to standardized CSV format  
- **Consolidates** multiple datasets into a single unified output
- **Provides** a user-friendly Streamlit interface for configuration

### Supported Data

- **Geographic Coverage**: 15+ Indian states, 500+ RTOs
- **Temporal Range**: 2022-2025 (monthly data)
- **Vehicle Categories**: E2W, L3G, L3P, L5G, L5P, ICE
- **Data Source**: [Vahan Dashboard](https://vahan.parivahan.gov.in/vahan4dashboard/)

---

## Installation

### Prerequisites

- Python 3.8 or higher
- Google Chrome browser
- Stable internet connection

### Quick Setup

```bash
# Clone the repository
git clone https://github.com/ryl-tushar04/ProsParity-Vaahan-WebScraper.git
cd vahan-automation-pipeline

# Create virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt
```

### Requirements

```
streamlit
pandas
selenium
python-dotenv
openpyxl
webdriver-manager
```

---

## Usage

### Launch the Application

```bash
streamlit run app.py
```

The application will open in your browser at `http://localhost:8501`

### Configuration Steps

1. **Select States**: Choose one or more states from the dropdown
2. **Select Years**: Pick years between 2022-2025
3. **Select Products**: Choose vehicle categories (E2W, L3G, L3P, L5G, L5P, ICE)
4. **Filter RTOs** (Optional): Enter specific RTO names, comma-separated
5. **Start Pipeline**: Click "START FULL PIPELINE" button
6. **Monitor Progress**: Watch real-time logs in the expandable section
7. **Download Results**: Click download button once processing completes

### Command-Line Mode

For automated execution without the UI:

```bash
python main.py
```

Note: Edit `user_config.json` manually for custom configurations.

---

## Architecture

```
User Interface (Streamlit)
         ↓
Configuration Files (JSON)
         ↓
Web Scraper (Selenium) → Downloads Excel files
         ↓
File Converter → Processes to CSV
         ↓
Data Merger → Consolidates files
         ↓
Final Output (CSV)
```

### Project Structure

```
vahan-automation-pipeline/
├── app.py                    # Streamlit UI
├── main.py                   # Selenium scraper
├── file_converter.py         # Excel to CSV converter
├── data_merger.py            # CSV consolidation
├── states_and_year.json      # State/Year XPath mappings
├── RTO.json                  # RTO XPath mappings
├── user_config.json          # Runtime config (auto-generated)
├── progress.json             # Progress tracker (auto-generated)
├── downloads/                # Raw Excel files
├── processed_csv/            # Converted CSV files
├── Archive_2024/             # Manually downloaded files from 2024
├── final_output/             # Final consolidated dataset
└── requirements.txt          # Python dependencies
```

---

## Output Format

The final CSV contains the following structure:

| Column | Description | Example |
|--------|-------------|---------|
| State | State name | Maharashtra |
| RTO | RTO name and code | PUNE - MH12 |
| Variant | Vehicle category | E2W |
| OEM | Manufacturer name | Ola Electric |
| Date Columns | Monthly registration counts | 2025-01-31, 2025-02-28, etc. |

**Example Output:**
```csv
State,RTO,Variant,OEM,2025-01-31,2025-02-28,2025-03-31
Maharashtra,PUNE - MH12,E2W,Ola Electric,1250,1380,1425
Maharashtra,PUNE - MH12,E2W,Ather Energy,890,945,1020
```

---

## Configuration

### user_config.json

Runtime configuration file (auto-generated by UI):

```json
{
  "states_to_scrape": ["maharashtra", "uttar_pradesh"],
  "years_to_scrape": ["2024", "2025"],
  "products_to_scrape": ["E2W", "L3P"],
  "rto_filter_list": []
}
```

### Product Categories

| Code | Description | Fuel Type |
|------|-------------|-----------|
| E2W | Electric Two-Wheeler | Electric |
| L3G | Electric Three-Wheeler (Goods) | Electric |
| L3P | Electric Three-Wheeler (Passenger) | Electric |
| L5G | Three-Wheeler (Goods) | Electric |
| L5P | Three-Wheeler (Passenger) | Electric |
| ICE | Internal Combustion Engine 2W | Petrol/CNG |

---

## Features

- **Automated Data Collection**: Minimal manual intervention required
- **Progress Tracking**: Resume interrupted sessions automatically
- **Comprehensive Validation**: Verifies filter selections before extraction
- **Batch Processing**: Handles multiple RTOs and products in single run
- **Error Recovery**: Retry mechanisms for failed operations
- **Clean Output**: Standardized CSV format with deduplication

---

## Troubleshooting

### Common Issues

**Browser crashes during scraping**
- Reduce number of RTOs per run
- Check available system memory
- Update Chrome to latest version

**Empty CSV files**
- Verify internet connection
- Check Vahan portal accessibility
- Increase wait times in scraper settings

**"No CSV files found to merge"**
- Check `downloads/` folder for Excel files
- Verify file permissions
- Review logs in `processed_csv/` directory

### Debug Mode

To see browser actions in real-time, edit `main.py`:

```python
HEADLESS_MODE = False  # Set to False for visible browser
```

---

## Technical Details

### Technology Stack

- **Language**: Python 3.8+
- **Web Automation**: Selenium WebDriver 4.15.0
- **Data Processing**: Pandas 2.0.3
- **UI Framework**: Streamlit 1.28.0
- **Excel Handling**: OpenPyXL 3.1.2

---

## Development

### Contributing

Contributions are welcome! Please follow these guidelines:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/new-feature`)
3. Commit your changes (`git commit -m 'Add new feature'`)
4. Push to the branch (`git push origin feature/new-feature`)
5. Open a Pull Request

### Code Standards

- Follow PEP 8 style guidelines
- Add docstrings to functions
- Include error handling
- Update documentation for new features

---

## Acknowledgements

This project was developed during an internship at **ProsParity** under the guidance of **Rammuni Diwan**.

**Data Source**: Vehicle registration data is sourced from the Vahan Dashboard, maintained by the Ministry of Road Transport & Highways, Government of India.

**Special Thanks**:
- Supervisor: Rammuni Diwan
- Organization: ProsParity

---

## Contact

**Developer**: Tushar Saxena  
**Email**: tusharsaxena2078@gmail.com  
**LinkedIn**: [Tushar Saxena](https://www.linkedin.com/in/tushar-saxena0410/)  
**GitHub**: [ryl-tushar04](https://github.com/ryl-tushar04)

---

**Project Status**: Active Development  
**Last Updated**: December 2024
